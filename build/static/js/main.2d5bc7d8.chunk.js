(this["webpackJsonpmy-image-app"]=this["webpackJsonpmy-image-app"]||[]).push([[0],{13:function(e,t,a){e.exports=a(21)},18:function(e,t,a){},20:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(7),i=a.n(l),u=(a(18),a(4)),o=a.n(u),c=a(8),s=a(1),m=a(2),p=a(9),d=a(10),h=a(3),b=a(12),g=a(11),f=(a(20),a(5)),E=function(e){Object(b.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).compressImage=e.compressImage.bind(Object(h.a)(e)),e.handleChange=e.handleChange.bind(Object(h.a)(e)),e.state={rendered:!1,maxSizeKB:5,maxWidthOrHeight:2e4,webWorker:{fileName:null,progress:null,inputSize:null,outputSize:null,inputUrl:null,outputUrl:null},mainThread:{progress:null,inputSize:null,outputSize:null,inputUrl:null,outputUrl:null}},e}return Object(d.a)(a,[{key:"handleChange",value:function(e){var t=this;return function(a){t.setState(Object(m.a)({},e,a.currentTarget.value))}}},{key:"handleSizeChange",value:function(e){var t=this,a=this.state.rendered;return function(n){t.setState(Object(m.a)({},e,n.currentTarget.value)),a&&(console.log("rerender?"),t.setState({rendered:!1}))}}},{key:"onProgress",value:function(e,t){var a=t?"webWorker":"mainThread";this.setState((function(t){return Object(s.a)(Object(s.a)({},t),{},Object(m.a)({},a,Object(s.a)(Object(s.a)({},t[a]),{},{progress:e})))}))}},{key:"compressImage",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n,r,l,i,u=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.rendered=!1,n=t.target.files[0],console.log("input",n),e.t0=console,e.next=6,f.a.getExifOrientation(n);case 6:return e.t1=e.sent,e.t0.log.call(e.t0,"ExifOrientation",e.t1),r=a?"webWorker":"mainThread",this.setState((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},r,Object(s.a)(Object(s.a)({},e[r]),{},{inputSize:(n.size/1024/1024).toFixed(2),inputUrl:URL.createObjectURL(n)})))})),l={maxIteration:100,alwaysKeepResolution:1,maxSizeMB:this.state.maxSizeKB/1024,useWebWorker:a,onProgress:function(e){return u.onProgress(e,a)}},e.next=13,Object(f.a)(n,l);case 13:i=e.sent,console.log("output",i),this.setState({fileName:i.name}),this.setState({rendered:!0}),this.setState((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},r,Object(s.a)(Object(s.a)({},e[r]),{},{outputSize:(i.size/1024/1024).toFixed(5),outputUrl:URL.createObjectURL(i)})))}));case 18:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.webWorker,n=t.mainThread,l=t.maxSizeKB;return r.a.createElement("div",{className:"App"},r.a.createElement("div",null,"Options:",r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"maxSizeKB"},"max file size in kb:",r.a.createElement("input",{type:"number",id:"maxSizeKB",name:"maxSizeKB",value:l,onChange:this.handleSizeChange("maxSizeKB")})),r.a.createElement("br",null),r.a.createElement("hr",null)),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"main-thread"},"Browsers based compression"," ",r.a.createElement("input",{id:"main-thread",type:"file",accept:"image/*",onChange:function(t){return e.compressImage(t,!1)}})),r.a.createElement("p",null," ",n.inputSize&&r.a.createElement("span",null,"Source image size: ",1024*n.inputSize," kb"),r.a.createElement("br",null),n.progress&&0==this.state.rendered&&r.a.createElement("span",null,"Compressing... ",n.progress," %"),n.outputSize&&1==this.state.rendered&&r.a.createElement("span",null,", Output image size: ",1024*n.outputSize," kb.",r.a.createElement("br",null)," compressed size:",(n.outputSize/n.inputSize).toFixed(2),"% of original!",r.a.createElement("br",null),"Maximum filesize:",l," KB",r.a.createElement("br",null)," actual achieved size:",Math.round(1024*n.outputSize)," KB",r.a.createElement("br",null),Math.round(1024*n.outputSize)>l?"Error: Failed to compress to desired file size.":"success!"))),(n.inputUrl||a.inputUrl)&&1==this.state.rendered&&r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"input preview"),r.a.createElement("td",null,"output preview"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("img",{src:n.inputUrl||a.inputUrl,alt:"input"})),r.a.createElement("td",null,r.a.createElement("a",{href:n.outputUrl,download:this.state.fileName},"left click to download compressed image",r.a.createElement("br",null),r.a.createElement("img",{src:n.outputUrl||a.outputUrl,alt:"output"})))))))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.2d5bc7d8.chunk.js.map